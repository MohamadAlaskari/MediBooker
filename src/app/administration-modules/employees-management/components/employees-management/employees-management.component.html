<h4 class="text-success">Employees Management</h4>
<div class="line bg-success"></div>

<div class="container">
  <div class="row">
    <div class="col-md-10">
      <div class="search-section">
        <input type="text" class="form-control form-control-lg" placeholder="Search" [(ngModel)]="searchTerm">
      </div>
    </div>
    <div class="col-md-2">
      <button class="btn btn-primary mb-3 search" (click)="setEditModefalse()" data-bs-toggle="modal"
        data-bs-target="#modal">
        Add New Mitarbeiter
      </button>
    </div>
  </div>

  <div class="modal fade" id="modal" #Modal data-bs-keyboard="false" tabindex="-1" aria-labelledby="modal"
    aria-hidden="true">
    <div class="modal-dialog modal-dialog-scrollable">
      <div class="modal-content">
        <div class="modal-header">
          <h1 class="modal-title fs-5" id="loginmodal">Form</h1>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"
            (click)="resetForm()"></button>
        </div>
        <div class="modal-body">
          <form [formGroup]="signUpForm" (ngSubmit)="submit()">
            <div class="row g-3">
              <!-- Name -->
              <div class="col-md-6">
                <div class="form-floating">
                  <input type="text" class="form-control" id="name" placeholder="Name" formControlName="name"
                    autocomplete="current-name"
                    [class.is-invalid]="signUpForm.get('name')!.invalid && signUpForm.get('name')!.touched"
                    [class.is-valid]="signUpForm.get('name')!.valid && signUpForm.get('name')!.touched">
                  <label for="name" class="form-label">Name*</label>
                  <div *ngIf="(signUpForm.get('name')!.invalid && signUpForm.get('name')!.touched)"
                    class="invalid-feedback">
                    Please provide a valid name.
                  </div>
                </div>
              </div>

              <!-- Surname -->
              <div class="col-md-6">
                <div class="form-floating">
                  <input type="text" class="form-control" id="surname" placeholder="Surname" formControlName="surname"
                    autocomplete="current-surname"
                    [class.is-invalid]="signUpForm.get('surname')!.invalid && signUpForm.get('surname')!.touched"
                    [class.is-valid]="signUpForm.get('surname')!.valid && signUpForm.get('surname')!.touched">
                  <label for="surname" class="form-label">Surname*</label>
                  <div *ngIf="(signUpForm.get('surname')!.invalid && signUpForm.get('surname')!.touched)"
                    class="invalid-feedback">
                    Please provide a valid surname.
                  </div>
                </div>
              </div>

              <!-- Email -->
              <div class="col-md-6">
                <div class="form-floating">
                  <input type="email" class="form-control" id="email" placeholder="Email" formControlName="email"
                    autocomplete="current-email"
                    [class.is-invalid]="signUpForm.get('email')!.invalid && signUpForm.get('email')!.touched"
                    [class.is-valid]="signUpForm.get('email')!.valid && signUpForm.get('email')!.touched">
                  <label for="email" class="form-label">Email*</label>
                  <div *ngIf="(signUpForm.get('email')!.invalid && signUpForm.get('email')!.touched)"
                    class="invalid-feedback">
                    Please provide a valid email.
                  </div>
                </div>
              </div>

              <!-- Password -->
              <div class="col-md-6" *ngIf="!EditMode;">
                <div class="form-floating">
                  <input type="password" class="form-control" id="password" placeholder="Password"
                    formControlName="password" autocomplete="current-password"
                    [class.is-invalid]="signUpForm.get('password')!.invalid && signUpForm.get('password')!.touched"
                    [class.is-valid]="signUpForm.get('password')!.valid && signUpForm.get('password')!.touched">
                  <label for="password" class="form-label">Password*</label>
                  <div *ngIf="(signUpForm.get('password')!.invalid && signUpForm.get('password')!.touched)"
                    class="invalid-feedback">
                    Please provide a valid password.
                  </div>
                </div>
              </div>

              <!-- Street -->
              <div class="col-md-6">
                <div class="form-floating">
                  <input type="text" class="form-control" id="street" placeholder="Street" formControlName="street"
                    autocomplete="current-street"
                    [class.is-invalid]="signUpForm.get('street')!.invalid && signUpForm.get('street')!.touched"
                    [class.is-valid]="signUpForm.get('street')!.valid && signUpForm.get('street')!.touched">
                  <label for="street" class="form-label">Street*</label>
                  <div *ngIf="(signUpForm.get('street')!.invalid && signUpForm.get('street')!.touched)"
                    class="invalid-feedback">
                    Please provide a valid street.
                  </div>
                </div>
              </div>

              <!-- House Number -->
              <div class="col-md-6">
                <div class="form-floating">
                  <input type="text" class="form-control" id="hNr" placeholder="House Number" formControlName="hNr"
                    autocomplete="current-hNr"
                    [class.is-invalid]="signUpForm.get('hNr')!.invalid && signUpForm.get('hNr')!.touched"
                    [class.is-valid]="signUpForm.get('hNr')!.valid && signUpForm.get('hNr')!.touched">
                  <label for="hNr" class="form-label">House Number*</label>
                  <div *ngIf="(signUpForm.get('hNr')!.invalid && signUpForm.get('hNr')!.touched)"
                    class="invalid-feedback">
                    Please provide a valid House Number.
                  </div>
                </div>
              </div>

              <!-- Postcode -->
              <div class="col-md-6">
                <div class="form-floating">
                  <input type="text" class="form-control" id="postcode" placeholder="Postcode"
                    formControlName="postcode" autocomplete="current-postcode"
                    [class.is-invalid]="signUpForm.get('postcode')!.invalid && signUpForm.get('postcode')!.touched"
                    [class.is-valid]="signUpForm.get('postcode')!.valid && signUpForm.get('postcode')!.touched">
                  <label for="postcode" class="form-label">Postcode*</label>
                  <div *ngIf="(signUpForm.get('postcode')!.invalid && signUpForm.get('postcode')!.touched)"
                    class="invalid-feedback">
                    Please provide a valid postcode.
                  </div>
                </div>
              </div>

              <!-- City -->
              <div class="col-md-6">
                <div class="form-floating">
                  <input type="text" class="form-control" id="city" placeholder="City" formControlName="city"
                    autocomplete="current-city"
                    [class.is-invalid]="signUpForm.get('city')!.invalid && signUpForm.get('city')!.touched"
                    [class.is-valid]="signUpForm.get('city')!.valid && signUpForm.get('city')!.touched">
                  <label for="city" class="form-label">City*</label>
                  <div *ngIf="(signUpForm.get('city')!.invalid && signUpForm.get('city')!.touched)"
                    class="invalid-feedback">
                    Please provide a valid city.
                  </div>
                </div>
              </div>
            </div>

            <!-- Buttons -->
            <div class="modal-footer justify-content-center">
              <button type="submit" class="btn btn-primary modalbtn" *ngIf="EditMode; else editModeFalse"
                [disabled]="signUpForm.invalid">
                Update Mitarbeiter
              </button>
              <ng-template #editModeFalse>
                <button type="submit" class="btn btn-primary modalbtn" [disabled]="signUpForm.invalid">Add new
                  Mitarbeiter</button>
              </ng-template>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>



  <div class="row">
    <div class="col-md-12">
      <div class="table-responsive">
        <table class="table table-striped table-hover">
          <thead class="thead-dark">
            <tr>
              <th scope="col">#</th>
              <th scope="col">Name</th>
              <th scope="col">Surname</th>
              <th scope="col">Email</th>
              <th scope="col">Address</th>
              <th scope="col">Act</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let employee of filteredEmployees(); let i = index">
              <td>{{ i + 1 }}</td>
              <td>{{ employee.name }}</td>
              <td>{{ employee.surname }}</td>
              <td>{{ employee.email }}</td>
              <td
                (mouseenter)="showTooltip($event, [{ label: 'City', value: employee.city },{ label: 'street', value: employee.street},{ label: 'hNr', value: employee.hNr },{ label: 'Plz', value: employee.postcode}])"
                (mouseleave)="hideTooltip()">
                {{ employee.city }}
              </td>

              <td>
                <div class="dropdown">
                  <button class="btn btn-link dropdown-toggle custom-dropdown-button" type="button"
                    id="dropdownMenuButton" data-bs-toggle="dropdown" aria-expanded="false">
                    <i class="fas fa-ellipsis-v"></i>
                  </button>
                  <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                    <li><a class="dropdown-item" (click)="removeEmployee(employee.id)">Remove</a></li>
                    <li><a class="dropdown-item" (click)="editEmployee(employee.id)">Edit</a></li>
                  </ul>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>


</div>
